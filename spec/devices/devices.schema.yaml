# JSON Schema for device specification YAML files
# Validates the structure of devices.yaml

$schema: "http://json-schema.org/draft-07/schema#"
title: Device channel mapping schema
description: Schema for defining device categories and their required/optional channels
type: object

patternProperties:
  "^[a-z0-9_]+$":
    type: object
    required:
      - category
      - description
      - channels
    properties:
      category:
        description: Unique identifier for the device category
        type: string
        enum:
          - generic
          - air_conditioner
          - air_dehumidifier
          - air_humidifier
          - air_purifier
          - alarm
          - av_receiver
          - camera
          - door
          - doorbell
          - fan
          - game_console
          - heating_unit
          - lighting
          - lock
          - media
          - outlet
          - projector
          - pump
          - robot_vacuum
          - sensor
          - set_top_box
          - speaker
          - sprinkler
          - streaming_service
          - switcher
          - television
          - thermostat
          - valve
          - water_heater
          - window_covering

      name:
        description: Human-readable name for the device category (used in documentation)
        type: object
        properties:
          en:
            type: string
        required:
          - en
        additionalProperties: false

      description:
        description: Detailed description of the device category
        type: object
        properties:
          en:
            type: string
        required:
          - en
        additionalProperties: false

      docGroup:
        description: Documentation grouping for organizing device categories
        type: string
        enum:
          - climate_control
          - security
          - home_automation
          - entertainment
          - robotics
          - sensors
          - other

      useCases:
        description: Use case scenarios for documentation
        type: object
        properties:
          en:
            type: array
            items:
              type: object
              required:
                - title
                - description
              properties:
                title:
                  type: string
                description:
                  type: string
              additionalProperties: false
        additionalProperties: false

      developerNotes:
        description: Developer notes and implementation guidance
        type: object
        properties:
          en:
            type: array
            items:
              type: string
        additionalProperties: false

      constraints:
        description: Channel constraints defining relationships between channels
        type: object
        properties:
          oneOf:
            description: At most one channel from each group can be present (mutually exclusive)
            type: array
            items:
              type: array
              items:
                type: string
              minItems: 2
          oneOrMoreOf:
            description: At least one channel from each group must be present
            type: array
            items:
              type: array
              items:
                type: string
              minItems: 2
          mutuallyExclusiveGroups:
            description: Channel groups that cannot be mixed (e.g., outlet vs switcher)
            type: array
            items:
              type: array
              items:
                type: array
                items:
                  type: string
                minItems: 1
              minItems: 2
        additionalProperties: false

      channels:
        description: Map of channel categories supported by this device
        type: object
        patternProperties:
          "^[a-z0-9_]+$":
            type: object
            required:
              - category
              - required
              - multiple
              - description
            properties:
              category:
                description: Channel category identifier
                type: string
                enum:
                  - generic
                  - air_particulate
                  - air_quality
                  - alarm
                  - battery
                  - camera
                  - carbon_dioxide
                  - carbon_monoxide
                  - contact
                  - cooler
                  - dehumidifier
                  - device_information
                  - door
                  - doorbell
                  - electrical_energy
                  - electrical_power
                  - fan
                  - filter
                  - flow
                  - gas
                  - heater
                  - humidifier
                  - humidity
                  - illuminance
                  - leak
                  - light
                  - lock
                  - media_input
                  - media_playback
                  - microphone
                  - motion
                  - nitrogen_dioxide
                  - occupancy
                  - outlet
                  - ozone
                  - pressure
                  - robot_vacuum
                  - smoke
                  - speaker
                  - sulphur_dioxide
                  - switcher
                  - television
                  - temperature
                  - thermostat
                  - valve
                  - volatile_organic_compounds
                  - window_covering
              required:
                description: Whether this channel is required for the device
                type: boolean
              multiple:
                description: Whether multiple instances of this channel are allowed
                type: boolean
              description:
                description: Description of the channel's purpose for this device
                type: object
                properties:
                  en:
                    type: string
                required:
                  - en
                additionalProperties: false
            additionalProperties: false
        additionalProperties: false

    additionalProperties: false

additionalProperties: false
